{"version":3,"file":"js/431-legacy.bf4aa5c7.js","mappings":"oKAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,sBAAsB,CAACF,EAAG,MAAM,CAACE,YAAY,cAAc,CAACF,EAAG,MAAM,CAACE,YAAY,WAAWC,GAAG,CAAC,MAAQP,EAAIQ,aAAa,CAACR,EAAIS,GAAG,QAAQL,EAAG,OAAO,CAACJ,EAAIS,GAAG,WAAWL,EAAG,MAAM,CAACM,IAAI,UAAUJ,YAAY,WAAW,CAACF,EAAG,MAAM,CAACM,IAAI,eAAeJ,YAAY,WAAWC,GAAG,CAAC,MAAQP,EAAIW,YAAYX,EAAIY,GAAIZ,EAAa,WAAE,SAASa,EAAKC,GAAO,OAAOV,EAAG,MAAM,CAACW,IAAID,EAAME,MAAMhB,EAAIiB,iBAAmBH,EAAO,sBAAsB,SAAS,CAACd,EAAIS,GAAG,IAAIT,EAAIkB,GAAGL,EAAKM,OAAO,UAAS,KAAKf,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,QAAQ,CAACM,IAAI,aAAaU,MAAM,CAAC,IAAMpB,EAAIqB,SAAS,KAAO,OAAO,SAAW,IAAId,GAAG,CAAC,WAAaP,EAAIsB,kBAChuBC,EAAkB,G,sDCoBtB,GACAC,KAAAA,aACAC,KAFA,WAGA,OACAC,QAAAA,WACAP,MAAAA,GACAQ,eAAAA,EACAN,SAAAA,+KACAO,SAAAA,KACAC,UAAAA,GACAC,gBAAAA,EACAb,eAAAA,EACAc,UAAAA,OAGAC,QAAAA,CACAC,cADA,WACA,yKACAC,EAAAA,EAAAA,GAAAA,EAAAA,SADA,gBACAT,EADA,EACAA,KACAU,QAAAA,IAAAA,GACA,eACA,oBACA,aACA,wBACA,qCAPA,8CAWAC,SAZA,WAeA,IAFA,6BACA,KACA,mBACA,oBACA,yBACA,GACAjB,MAAAA,EAAAA,GAAAA,MAAAA,KAAAA,GACAkB,KAAAA,KAAAA,WAAAA,EAAAA,QAAAA,IAAAA,MAEAC,EAAAA,KAAAA,GAGA,kBAEAhB,UA3BA,WA4BA,kFAEAiB,WA9BA,SA8BAC,GACA,mBACA,OACA,cACA,UAEA7B,UApCA,WAqCAwB,QAAAA,IAAAA,KAAAA,iBACA,oBACAA,QAAAA,IAAAA,MACA,sBACA,gCAEAA,QAAAA,IAAAA,MACA,sBACA,+BAIAM,cAjDA,WAkDA,iBAEA,IADA,gCACA,gCACA,4BACA,YAKAjC,WA3DA,WA4DA,+BAGAkC,cA/DA,WAgEA,yCACA,wCACA,mCACA,oCACA,wEACA,WACA,EACA,sCACA,gCAEA,IAIAC,QA7FA,WA8FAR,QAAAA,IAAAA,KAAAA,OAAAA,QACA,0CACA,mCACA,sBAEAS,QAnGA,WAmGA,WACA,2BACA,mCC1H+Q,I,UCQ3QC,GAAY,OACd,EACA9C,EACAwB,GACA,EACA,KACA,WACA,MAIF,EAAesB,EAAiB,S,0FChBnBC,EAAkB,SAAUC,GACvC,OAAOC,EAAAA,EAAAA,GAAM,CACXC,OAAQ,MACRC,IAAK,eAELC,OAAQ,CAAEC,IAAKL,MAKNb,EAAgB,SAAUa,GACrC,OAAOC,EAAAA,EAAAA,GAAM,CACXC,OAAQ,MACRC,IAAK,SAELC,OAAQ,CAAEJ,GAAIA","sources":["webpack://demo-netease/./src/views/musicLyric/musicLyric.vue?2484","webpack://demo-netease/src/views/musicLyric/musicLyric.vue","webpack://demo-netease/./src/views/musicLyric/musicLyric.vue?5e18","webpack://demo-netease/./src/views/musicLyric/musicLyric.vue","webpack://demo-netease/./src/api/getMusicDetails.js"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"playMusicContainer\"},[_c('div',{staticClass:\"musicTitle\"},[_c('div',{staticClass:\"backIcon\",on:{\"click\":_vm.backRouter}},[_vm._v(\"返回\")]),_c('span',[_vm._v(\"虞姬叹\")])]),_c('div',{ref:\"content\",staticClass:\"content\"},[_c('div',{ref:\"lyricContent\",staticClass:\"lyricBox\",on:{\"click\":_vm.playMusic}},_vm._l((_vm.lyricList),function(item,index){return _c('div',{key:index,class:_vm.playMusicIndex === index? 'lyric playBackLyric':'lyric'},[_vm._v(\" \"+_vm._s(item.lyric)+\" \")])}),0)]),_c('div',{staticClass:\"musicContent\"},[_c('audio',{ref:\"audioAbout\",attrs:{\"src\":_vm.musicUrl,\"loop\":\"loop\",\"controls\":\"\"},on:{\"timeupdate\":_vm.musicPlay}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"playMusicContainer\">\r\n    <div class=\"musicTitle\">\r\n      <div class=\"backIcon\" @click=\"backRouter\">返回</div>\r\n      <span>虞姬叹</span>\r\n    </div>\r\n    <div class=\"content\" ref=\"content\">\r\n      <div class=\"lyricBox\" @click=\"playMusic\" ref=\"lyricContent\">\r\n        <div :class=\"playMusicIndex === index? 'lyric playBackLyric':'lyric'\" v-for=\"(item, index) in lyricList\" :key=\"index\">\r\n          {{ item.lyric }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"musicContent\">\r\n      <audio @timeupdate=\"musicPlay\" :src=\"musicUrl\" loop=\"loop\" controls ref=\"audioAbout\"></audio>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getMusicLyric } from '@/api/getMusicDetails.js'\r\nexport default {\r\n  name: 'musicLyric',\r\n  data () {\r\n    return {\r\n      musicId: 1479526505,\r\n      lyric: '',\r\n      autoPlayMusic: false,\r\n      musicUrl: 'https://m701.music.126.net/20240628114434/b17138dd6e45ee9d0d597283e123145d/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/28557930835/49ec/74b8/4483/2a23bfdfa57dc47213162fcd1f317154.mp3',\r\n      audioDom: null,\r\n      lyricList: [],\r\n      lyricItemHeight: 0,\r\n      playMusicIndex: 0,\r\n      musicHtml: null\r\n    }\r\n  },\r\n  methods: {\r\n    async setMusicLyric () {\r\n      const { data } = await getMusicLyric(this.musicId)\r\n      console.log(data)\r\n      if (data.code === 200) {\r\n        this.lyric = data.lrc.lyric\r\n        this.setLyric()\r\n        this.$nextTick(() => {\r\n          this.musicHtml = this.$refs.lyricContent\r\n        })\r\n      }\r\n    },\r\n    setLyric () {\r\n      const strList = this.lyric.split('\\n')\r\n      const arr = []\r\n      for (let i = 0; i < strList.length; i++) {\r\n        if (strList[i] && strList[i] !== '') {\r\n          const timeStr = strList[i].split(']')[0]\r\n          const obj = {\r\n            lyric: strList[i].split(']')[1],\r\n            time: this.setTimeStr(timeStr.replace('[', ''))\r\n          }\r\n          arr.push(obj)\r\n        }\r\n      }\r\n      this.lyricList = arr\r\n    },\r\n    musicPlay () {\r\n      this.musicHtml.style.transform = `translateY(-${this.offetDistance()}px)`\r\n    },\r\n    setTimeStr (timeStr) {\r\n      const timeList = timeStr.split(':')\r\n      const H = timeList[0]\r\n      const rightTime = (+timeList[1]) + (+H * 60)\r\n      return rightTime\r\n    },\r\n    playMusic () {\r\n      console.log(this.offetDistance())\r\n      if (this.autoPlayMusic) {\r\n        console.log('暂停')\r\n        this.autoPlayMusic = false\r\n        this.$refs.audioAbout.pause()\r\n      } else {\r\n        console.log('开始')\r\n        this.autoPlayMusic = true\r\n        this.$refs.audioAbout.play()\r\n      }\r\n    },\r\n    // 获取当前播放歌词下标\r\n    getMusicIndex () {\r\n      if (this.audioDom) {\r\n        const time = this.audioDom.currentTime\r\n        for (let i = 0; i < this.lyricList.length; i++) {\r\n          if (time < this.lyricList[i].time) {\r\n            return i - 1\r\n          }\r\n        }\r\n      }\r\n    },\r\n    backRouter () {\r\n      this.$router.replace('/like')\r\n    },\r\n    // 设置歌词偏移\r\n    offetDistance () {\r\n      this.playMusicIndex = this.getMusicIndex()\r\n      const countHeight = this.$refs.content.clientHeight / 2\r\n      const item = document.querySelector('.lyric')\r\n      this.lyricItemHeight = item.clientHeight\r\n      const offet = this.lyricItemHeight * this.playMusicIndex + (this.lyricItemHeight / 2) - countHeight\r\n      if (offet < 0) {\r\n        return 0\r\n      } else if (offet - (this.musicHtml.clientHeight - (countHeight * 2)) > 0) {\r\n        return this.musicHtml.clientHeight - (countHeight * 2)\r\n      } else {\r\n        return offet\r\n      }\r\n    }\r\n  },\r\n  created () {\r\n    console.log(this.$route.params)\r\n    this.musicUrl = this.$route.params.musicURL\r\n    this.musicId = this.$route.params.id\r\n    this.setMusicLyric()\r\n  },\r\n  mounted () {\r\n    this.$nextTick(() => {\r\n      this.audioDom = this.$refs.audioAbout\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.playMusicContainer {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  width: 100%;\r\n  background-color: #000;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n}\r\n.musicTitle {\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 2.6667rem;\r\n  line-height: 2.6667rem;\r\n  color: #fff;\r\n  width: 100%;\r\n  font-size: .96rem;\r\n  // background-color: red;\r\n}\r\n.backIcon {\r\n  position: absolute;\r\n  width: 2.6667rem;\r\n  height: 1.3333rem;\r\n  line-height: 1.3333rem;\r\n  top: 50%;\r\n  left: .8rem;\r\n  font-size: .64rem;\r\n  transform: translateY(-50%);\r\n}\r\n.content {\r\n  width: 100%;\r\n  height: 70vh;\r\n  margin-top: 5vh;\r\n  // border: 1px solid #ccc;\r\n  overflow: hidden;\r\n}\r\n.musicContent {\r\n  position: fixed;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  bottom: 0;\r\n  color: #fff;\r\n  left: 50%;\r\n  transform: translateX(-50%);\r\n  width: 100%;\r\n  height: 2.8rem;\r\n  z-index: 1000;\r\n  // background-color: white;\r\n  background-color: #000;\r\n  border-top: .0267rem solid #ccc;\r\n}\r\n.lyricBox {\r\n  // transform: translateY(-80px);\r\n  transition: all 0.3s;\r\n}\r\n.lyric {\r\n  height: 1.6rem;\r\n  line-height: 1.6rem;\r\n  color: #888;\r\n  text-align: center;\r\n  // border: 1px solid #ccc;\r\n  // border: 1px solid #ccc;\r\n  font-size: .7467rem;\r\n  transition: all 0.2s;\r\n}\r\n.playBackLyric {\r\n  color: #fff;\r\n  transform: scale(1.3);\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./musicLyric.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./musicLyric.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./musicLyric.vue?vue&type=template&id=d0c9ea70&scoped=true&\"\nimport script from \"./musicLyric.vue?vue&type=script&lang=js&\"\nexport * from \"./musicLyric.vue?vue&type=script&lang=js&\"\nimport style0 from \"./musicLyric.vue?vue&type=style&index=0&id=d0c9ea70&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d0c9ea70\",\n  null\n  \n)\n\nexport default component.exports","import axios from '@/utils/request.js'\r\n\r\n// 获取歌曲详情\r\nexport const getMusicDetails = function (id) {\r\n  return axios({\r\n    method: 'get',\r\n    url: '/song/detail',\r\n    // id 为歌曲的 ID\r\n    params: { ids: id }\r\n  })\r\n}\r\n\r\n// 获取歌曲详情\r\nexport const getMusicLyric = function (id) {\r\n  return axios({\r\n    method: 'get',\r\n    url: '/lyric',\r\n    // id 为歌曲的 ID\r\n    params: { id: id }\r\n  })\r\n}\r\n"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","backRouter","_v","ref","playMusic","_l","item","index","key","class","playMusicIndex","_s","lyric","attrs","musicUrl","musicPlay","staticRenderFns","name","data","musicId","autoPlayMusic","audioDom","lyricList","lyricItemHeight","musicHtml","methods","setMusicLyric","getMusicLyric","console","setLyric","time","arr","setTimeStr","timeStr","getMusicIndex","offetDistance","created","mounted","component","getMusicDetails","id","axios","method","url","params","ids"],"sourceRoot":""}