"use strict";(self["webpackChunkdemo_netease"]=self["webpackChunkdemo_netease"]||[]).push([[431],{4431:function(t,i,e){e.r(i),e.d(i,{default:function(){return m}});var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"playMusicContainer"},[e("div",{staticClass:"musicTitle"},[e("div",{staticClass:"backIcon",on:{click:t.backRouter}},[t._v("返回")]),e("span",[t._v("虞姬叹")])]),e("div",{ref:"content",staticClass:"content"},[e("div",{ref:"lyricContent",staticClass:"lyricBox",on:{click:t.playMusic}},t._l(t.lyricList,(function(i,s){return e("div",{key:s,class:t.playMusicIndex===s?"lyric playBackLyric":"lyric"},[t._v(" "+t._s(i.lyric)+" ")])})),0)]),e("div",{staticClass:"musicContent"},[e("audio",{ref:"audioAbout",attrs:{src:t.musicUrl,loop:"loop",controls:""},on:{timeupdate:t.musicPlay}})])])},c=[],n=e(6198),r=(e(4916),e(3123),e(5306),e(8975),e(6315)),u={name:"musicLyric",data:function(){return{musicId:1479526505,lyric:"",autoPlayMusic:!1,musicUrl:"https://m701.music.126.net/20240628114434/b17138dd6e45ee9d0d597283e123145d/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/28557930835/49ec/74b8/4483/2a23bfdfa57dc47213162fcd1f317154.mp3",audioDom:null,lyricList:[],lyricItemHeight:0,playMusicIndex:0,musicHtml:null}},methods:{setMusicLyric:function(){var t=this;return(0,n.Z)(regeneratorRuntime.mark((function i(){var e,s;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,(0,r.y)(t.musicId);case 2:e=i.sent,s=e.data,console.log(s),200===s.code&&(t.lyric=s.lrc.lyric,t.setLyric(),t.$nextTick((function(){t.musicHtml=t.$refs.lyricContent})));case 6:case"end":return i.stop()}}),i)})))()},setLyric:function(){for(var t=this.lyric.split("\n"),i=[],e=0;e<t.length;e++)if(t[e]&&""!==t[e]){var s=t[e].split("]")[0],c={lyric:t[e].split("]")[1],time:this.setTimeStr(s.replace("[",""))};i.push(c)}this.lyricList=i},musicPlay:function(){this.musicHtml.style.transform="translateY(-".concat(this.offetDistance(),"px)")},setTimeStr:function(t){var i=t.split(":"),e=i[0],s=+i[1]+60*+e;return s},playMusic:function(){console.log(this.offetDistance()),this.autoPlayMusic?(console.log("暂停"),this.autoPlayMusic=!1,this.$refs.audioAbout.pause()):(console.log("开始"),this.autoPlayMusic=!0,this.$refs.audioAbout.play())},getMusicIndex:function(){if(this.audioDom)for(var t=this.audioDom.currentTime,i=0;i<this.lyricList.length;i++)if(t<this.lyricList[i].time)return i-1},backRouter:function(){this.$router.replace("/like")},offetDistance:function(){this.playMusicIndex=this.getMusicIndex();var t=this.$refs.content.clientHeight/2,i=document.querySelector(".lyric");this.lyricItemHeight=i.clientHeight;var e=this.lyricItemHeight*this.playMusicIndex+this.lyricItemHeight/2-t;return e<0?0:e-(this.musicHtml.clientHeight-2*t)>0?this.musicHtml.clientHeight-2*t:e}},created:function(){console.log(this.$route.params),this.musicUrl=this.$route.params.musicURL,this.musicId=this.$route.params.id,this.setMusicLyric()},mounted:function(){var t=this;this.$nextTick((function(){t.audioDom=t.$refs.audioAbout}))}},o=u,a=e(1001),l=(0,a.Z)(o,s,c,!1,null,"d0c9ea70",null),m=l.exports},6315:function(t,i,e){e.d(i,{F:function(){return c},y:function(){return n}});var s=e(5972),c=function(t){return(0,s.Z)({method:"get",url:"/song/detail",params:{ids:t}})},n=function(t){return(0,s.Z)({method:"get",url:"/lyric",params:{id:t}})}}}]);
//# sourceMappingURL=431-legacy.bf4aa5c7.js.map